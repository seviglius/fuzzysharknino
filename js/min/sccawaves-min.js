function createPath(t){var e=new Path({fillColor:null,strokeColor:"white",strokeWidth:8});springs=[];for(var i=0;i<=values.amount;i++){var s=e.add(new Point(i/values.amount,.5)*size),n=s.point;if((0==i||i==values.amount)&&(n.y+=size.height),n.px=n.x,n.py=n.y,n.fixed=2>i||i>values.amount-2,i>0){var a=new Spring(s.previous.point,n,t);springs.push(a)}}return e.position.x-=size.width/4,e}function onResize(){path&&path.remove(),size=view.bounds.size*[2,1],path=createPath(.1)}function onMouseMove(t){var e=path.getNearestLocation(t.point),i=e.segment,s=i.point;if(!s.fixed&&e.distance<size.height/4){var n=t.point.y;if(s.y+=(n-s.y)/6,i.previous&&!i.previous.fixed){var a=i.previous.point;a.y+=(n-a.y)/24}if(i.next&&!i.next.fixed){var o=i.next.point;o.y+=(n-o.y)/24}}}function onFrame(t){updateWave(path)}function updateWave(t){for(var e=1-values.friction*values.timeStep*values.timeStep,i=0,s=t.segments.length;s>i;i++){var n=t.segments[i].point,a=(n.y-n.py)*e;n.py=n.y,n.y=Math.max(n.y+a,0)}for(var o=0,s=springs.length;s>o;o++)springs[o].update();t.smooth({type:"continuous"})}function onKeyDown(t){"black"==path.fillColor?path.fillColor=null:null==path.fillColor&&(path.fillColor="black")}var values={friction:.8,timeStep:.01,amount:15,mass:2,count:0};values.invMass=1/values.mass;var path,springs,size=view.size*[1.2,1],Spring=function(t,e,i,s){this.a=t,this.b=e,this.restLength=s||80,this.strength=i?i:.55,this.mamb=values.invMass*values.invMass};Spring.prototype.update=function(){var t=this.b-this.a,e=t.length,i=(e-this.restLength)/(e*this.mamb)*this.strength;t.y*=i*values.invMass*.2,this.a.fixed||(this.a.y+=t.y),this.b.fixed||(this.b.y-=t.y)};